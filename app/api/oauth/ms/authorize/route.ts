import { NextResponse } from 'next/server'; export async function GET(){ const tenant=process.env.MS_TENANT_ID||'common'; const p=new URLSearchParams({ client_id: process.env.MS_CLIENT_ID!, response_type:'code', redirect_uri: process.env.MS_REDIRECT_URI!, response_mode:'query', scope:'offline_access Mail.ReadWrite openid profile email' }); return NextResponse.redirect(`https://login.microsoftonline.com/${tenant}/oauth2/v2.0/authorize?`+p.toString()); }