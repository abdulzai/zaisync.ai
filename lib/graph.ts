export async function createGraphDraft(accessToken:string, subject:string, body:string){ const r=await fetch('https://graph.microsoft.com/v1.0/me/messages',{ method:'POST', headers:{ Authorization:`Bearer ${accessToken}`, 'Content-Type':'application/json' }, body: JSON.stringify({ subject, body:{ contentType:'Text', content: body||'' }, toRecipients: [] }) }); if(!r.ok){ const t=await r.text(); throw new Error(`Graph draft failed: ${r.status} ${t}`); } const j=await r.json(); return { id: j.id }; }